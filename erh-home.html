<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSOG STORES - HOME</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --dark-blue: #0a192f;
            --medium-blue: #172a45;
            --light-pink: #ff6b8b;
            --accent-gold: #e6c78a;
            --soft-teal: #81c8be;
            --text-primary: #f0e6ef;
            --text-secondary: #b8b8d1;
        }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Poppins', sans-serif;
            color: var(--text-primary);
            overflow-x: hidden;
        }
        
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--dark-blue);
            z-index: -2;
        }
        
        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 25% 25%, rgba(255, 107, 139, 0.1) 0%, transparent 50%);
            background-size: 400% 400%;
            z-index: -1;
            animation: gradientMove 30s ease infinite;
        }
        
        @keyframes gradientMove {
            0% { background-position: 0% 0%; }
            50% { background-position: 100% 100%; }
            100% { background-position: 0% 0%; }
        }
        
        .container {
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        /* Login Modal Styles */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 25, 47, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .login-form {
            background: var(--medium-blue);
            padding: 40px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            border-left: 4px solid var(--light-pink);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }
        
        .login-form h2 {
            color: var(--light-pink);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .login-input-group {
            margin-bottom: 20px;
        }
        
        .login-input-group label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .login-input-group input {
            width: 100%;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--light-pink);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            box-sizing: border-box;
            font-size: 16px;
        }
        
        .login-btn {
            width: 100%;
            padding: 12px;
            background: var(--light-pink);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .login-btn:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
        }
        
        .login-error {
            color: #ff4757;
            font-size: 14px;
            text-align: center;
            margin-top: 10px;
            display: none;
        }
        
        /* User Info Bar */
        .user-info {
            background: var(--medium-blue);
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--accent-gold);
        }
        
        .user-email {
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .logout-btn {
            background: var(--soft-teal);
            color: var(--dark-blue);
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
        }
        
        /* Navigation Styles */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--medium-blue);
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--light-pink);
        }
        
        .logo span {
            font-size: 14px;
            color: var(--text-secondary);
            display: block;
            margin-top: 5px;
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
        }
        
        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-link:hover, .nav-link.active {
            color: var(--light-pink);
            background-color: rgba(255, 107, 139, 0.1);
        }
        
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -17px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--light-pink);
            border-radius: 3px 3px 0 0;
        }
        
        .datetime {
            text-align: right;
        }
        
        #time {
            font-size: 22px;
            font-weight: 300;
        }
        
        #date {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .metric-card {
            background-color: var(--medium-blue);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .metric-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .metric-icon {
            font-size: 30px;
            margin-right: 15px;
            color: var(--light-pink);
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 500;
        }
        
        .metric-label {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .weekly-summary {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .target-card {
            background-color: var(--medium-blue);
            border-radius: 8px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            border-left: 4px solid var(--light-pink);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .target-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .progress-container {
            margin-top: 15px;
            background-color: rgba(255, 107, 139, 0.1);
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--light-pink), var(--accent-gold));
            border-radius: 10px;
            width: 65%;
            position: relative;
        }
        
        .progress-text {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            color: var(--dark-blue);
            font-weight: bold;
        }
        
        .target-details {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .weekly-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .stat-card {
            background-color: var(--medium-blue);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s ease-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .stat-card:nth-child(1) { transition-delay: 0.2s; }
        .stat-card:nth-child(2) { transition-delay: 0.4s; }
        .stat-card:nth-child(3) { transition-delay: 0.6s; }
        
        .stat-icon {
            font-size: 24px;
            margin-right: 15px;
            color: var(--light-pink);
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 500;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .products-section {
            background-color: var(--medium-blue);
            border-radius: 8px;
            padding: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .products-section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .section-header {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 107, 139, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 500;
            color: var(--light-pink);
            margin: 0;
        }
        
        .product-count {
            font-size: 14px;
            color: var(--text-secondary);
            background: rgba(255, 107, 139, 0.1);
            padding: 4px 10px;
            border-radius: 12px;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }
        
        .product-card {
            background: linear-gradient(135deg, rgba(45, 45, 68, 0.8), rgba(26, 26, 46, 0.9));
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 107, 139, 0.1);
            transform: scale(0.95);
            transition: all 0.3s ease;
            opacity: 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        
        .product-card.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        .product-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .product-image {
            height: 140px;
            background-size: cover;
            background-position: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }
        
        .product-image::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(26, 26, 46, 0.1), rgba(26, 26, 46, 0.7));
        }
        
        .product-card:hover .product-image {
            transform: scale(1.05);
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-category {
            display: inline-block;
            padding: 3px 10px;
            background-color: var(--light-pink);
            color: var(--dark-blue);
            font-size: 10px;
            font-weight: 500;
            border-radius: 4px;
            margin-bottom: 8px;
        }
        
        .new-arrival-badge {
            display: inline-block;
            padding: 3px 10px;
            background-color: var(--accent-gold);
            color: var(--dark-blue);
            font-size: 10px;
            font-weight: 500;
            border-radius: 4px;
            margin-bottom: 8px;
            margin-left: 5px;
        }
        
        .product-name {
            font-size: 16px;
            margin: 5px 0;
            transition: color 0.3s ease;
        }
        
        .product-card:hover .product-name {
            color: var(--light-pink);
        }
        
        .product-price {
            color: var(--soft-teal);
            font-weight: 500;
            margin: 5px 0;
        }
        
        .product-meta {
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
        }
        
        .currency::before {
            content: "Ksh ";
        }
        
        /* Admin Panel Styles */
        .admin-panel {
            background: var(--medium-blue);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-gold);
        }
        
        .admin-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .admin-section h4 {
            color: var(--accent-gold);
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .admin-input-group {
            margin-bottom: 10px;
        }
        
        .admin-input-group label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .admin-input-group input, .admin-input-group textarea {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--light-pink);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            box-sizing: border-box;
        }
        
        .admin-input-group textarea {
            height: 60px;
            resize: vertical;
        }
        
        .admin-btn {
            background: var(--light-pink);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .admin-btn.secondary {
            background: var(--soft-teal);
            color: var(--dark-blue);
        }
        
        .admin-btn:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
        }
        
        .toggle-admin-btn {
            background: var(--accent-gold);
            color: var(--dark-blue);
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        /* Product Detail Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(10, 25, 47, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .product-modal {
            background: var(--medium-blue);
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .product-modal {
            transform: scale(1);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            z-index: 10;
        }
        
        .modal-content {
            display: flex;
            flex-direction: column;
        }
        
        @media (min-width: 768px) {
            .modal-content {
                flex-direction: row;
            }
        }
        
        .modal-image {
            height: 300px;
            flex: 1;
            background-size: cover;
            background-position: center;
            border-radius: 12px 12px 0 0;
        }
        
        @media (min-width: 768px) {
            .modal-image {
                height: auto;
                border-radius: 12px 0 0 12px;
                flex: 0 0 40%;
            }
        }
        
        .modal-details {
            flex: 1;
            padding: 25px;
        }
        
        .modal-category {
            display: inline-block;
            padding: 5px 12px;
            background-color: var(--light-pink);
            color: var(--dark-blue);
            font-size: 12px;
            font-weight: 500;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .modal-title {
            font-size: 24px;
            margin: 10px 0;
            color: var(--light-pink);
        }
        
        .modal-price {
            font-size: 22px;
            color: var(--soft-teal);
            margin: 10px 0;
        }
        
        .modal-description {
            margin: 15px 0;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        
        .modal-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .modal-stat {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .modal-stat-value {
            font-size: 18px;
            font-weight: 600;
            color: var(--accent-gold);
        }
        
        .modal-stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Sales Tracker Bar Chart */
        .sales-bars {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            height: 150px;
            margin-top: 20px;
            padding: 0 10px;
        }
        
        .sales-bar {
            flex: 1;
            margin: 0 5px;
            background: rgba(255, 107, 139, 0.2);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .sales-bar:hover {
            background: rgba(255, 107, 139, 0.3);
        }
        
        .sales-bar-fill {
            background: linear-gradient(to top, var(--light-pink), var(--accent-gold));
            border-radius: 4px 4px 0 0;
            width: 100%;
            position: absolute;
            bottom: 0;
            transition: height 1s ease-out;
        }
        
        .sales-bar-label {
            position: absolute;
            bottom: -25px;
            width: 100%;
            text-align: center;
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .sales-bar-value {
            position: absolute;
            top: -20px;
            width: 100%;
            text-align: center;
            font-size: 11px;
            color: var(--accent-gold);
        }
        
        @media (max-width: 768px) {
            .top-nav {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .nav-links {
                width: 100%;
                justify-content: space-between;
            }
            
            .weekly-summary {
                grid-template-columns: 1fr;
            }
            
            .datetime {
                width: 100%;
                text-align: left;
            }
            
            .modal-content {
                flex-direction: column;
            }
            
            .modal-image {
                height: 250px;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="background"></div>
    <div class="background-pattern"></div>
    
    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-form">
            <h2>üîê Store Administrator Login</h2>
            <div class="login-input-group">
                <label for="loginEmail">Email Address</label>
                <input type="email" id="loginEmail" placeholder="admin@dsogstores.com">
            </div>
            <div class="login-input-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password">
            </div>
            <button class="login-btn" id="loginBtn">Sign In</button>
            <div class="login-error" id="loginError">
                Invalid email or password. Please try again.
            </div>
            <div style="text-align: center; color: var(--text-secondary); font-size: 12px; margin-top: 15px;">
                Only authorized administrators can access the admin panel.
            </div>
        </div>
    </div>
    
    <div class="container">
        <nav class="top-nav">
            <div class="logo">
                NBO-DSOG001
                <span>Fashion & Home Accessories ‚Ä¢ Week 24 Sales</span>
            </div>
            <div class="nav-links">
                <a href="#" class="nav-link active">Home</a>
                <a href="erh.html" class="nav-link">Workspace</a>
                <a href="customer-app.html" class="nav-link">Marketplace</a>
            </div>
            <div class="datetime">
                <div id="time">10:45 AM</div>
                <div id="date">Friday, June 10, 2023</div>
            </div>
        </nav>
        
        <!-- User Info Bar (Visible when logged in) -->
        <div class="user-info" id="userInfo" style="display: none;">
            <div class="user-email" id="userEmail">admin@dsogstores.com</div>
            <button class="logout-btn" id="logoutBtn">üö™ Logout</button>
        </div>
        
        <!-- Admin Panel (Only visible when logged in) -->
        <button class="toggle-admin-btn" id="toggleAdminBtn" style="display: none;">üë§ Show Admin Panel</button>
        <div class="admin-panel" id="adminPanel" style="display: none;">
            <h3 style="color: var(--accent-gold); margin-bottom: 20px;">üéõÔ∏è Admin Dashboard - Update All Content</h3>
            
            <!-- Metrics Section -->
            <div class="admin-section">
                <h4>üìä Key Metrics</h4>
                <div class="admin-grid">
                    <div class="admin-input-group">
                        <label>Weekly Sales (Ksh)</label>
                        <input type="number" id="adminWeeklySales" placeholder="14285">
                    </div>
                    <div class="admin-input-group">
                        <label>Growth %</label>
                        <input type="number" id="adminGrowth" placeholder="12">
                    </div>
                    <div class="admin-input-group">
                        <label>Products Sold</label>
                        <input type="number" id="adminProductsSold" placeholder="117">
                    </div>
                    <div class="admin-input-group">
                        <label>Days Remaining</label>
                        <input type="number" id="adminDaysRemaining" placeholder="4">
                    </div>
                </div>
            </div>
            
            <!-- Weekly Stats -->
            <div class="admin-section">
                <h4>üè™ Store Statistics</h4>
                <div class="admin-grid">
                    <div class="admin-input-group">
                        <label>Active Franchises</label>
                        <input type="number" id="adminFranchises" placeholder="8">
                    </div>
                    <div class="admin-input-group">
                        <label>Staff Members</label>
                        <input type="number" id="adminStaff" placeholder="24">
                    </div>
                    <div class="admin-input-group">
                        <label>Pending Deliveries</label>
                        <input type="number" id="adminDeliveries" placeholder="3">
                    </div>
                </div>
            </div>
            
            <!-- Sales Target -->
            <div class="admin-section">
                <h4>üéØ Sales Target</h4>
                <div class="admin-grid">
                    <div class="admin-input-group">
                        <label>Weekly Target (Ksh)</label>
                        <input type="number" id="adminWeeklyTarget" placeholder="22000">
                    </div>
                    <div class="admin-input-group">
                        <label>Daily Sales (Mon-Sun, comma separated)</label>
                        <input type="text" id="adminDailySales" placeholder="2100,3200,2800,3900,2285,0,0">
                    </div>
                </div>
            </div>
            
            <!-- Best Selling Products -->
            <div class="admin-section">
                <h4>üî• Best Selling Products (Max: 4)</h4>
                <div id="bestSellingProductsAdmin">
                    <!-- Will be populated by JavaScript -->
                </div>
                <button class="admin-btn secondary" id="addBestSellingBtn" onclick="addProduct('bestSellingProducts')">+ Add Product</button>
            </div>
            
            <!-- New Arrivals -->
            <div class="admin-section">
                <h4>üÜï New Arrivals (Max: 4)</h4>
                <div id="newArrivalsAdmin">
                    <!-- Will be populated by JavaScript -->
                </div>
                <button class="admin-btn secondary" id="addNewArrivalBtn" onclick="addProduct('newArrivals')">+ Add Product</button>
            </div>
            
            <div style="margin-top: 20px;">
                <button class="admin-btn" onclick="updateAllData()">üíæ Update All Data</button>
                <button class="admin-btn secondary" onclick="loadCurrentData()">üîÑ Load Current Data</button>
                <button class="admin-btn secondary" onclick="resetToDefault()">üîÑ Reset to Default</button>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="metrics-grid">
                <div class="metric-card" id="metricCard1">
                    <div class="metric-icon">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div>
                        <div class="metric-value currency">14,285</div>
                        <div class="metric-label">Weekly Sales</div>
                    </div>
                </div>
                <div class="metric-card" id="metricCard2">
                    <div class="metric-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div>
                        <div class="metric-value">+12%</div>
                        <div class="metric-label">vs Last Week</div>
                    </div>
                </div>
                <div class="metric-card" id="metricCard3">
                    <div class="metric-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div>
                        <div class="metric-value">4</div>
                        <div class="metric-label">Days Remaining</div>
                    </div>
                </div>
                <div class="metric-card" id="metricCard4">
                    <div class="metric-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <div>
                        <div class="metric-value">117</div>
                        <div class="metric-label">Products Sold</div>
                    </div>
                </div>
            </div>
            
            <div class="weekly-summary">
                <div class="target-card" id="targetCard">
                    <h3>Weekly Sales Target</h3>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar">
                            <span class="progress-text">65%</span>
                        </div>
                    </div>
                    <div class="target-details">
                        <span>Current: <span class="currency">14,285</span></span>
                        <span>Target: <span class="currency">22,000</span></span>
                        <span>Remaining: <span class="currency">7,715</span></span>
                    </div>
                    
                    <!-- Bar chart for sales tracker -->
                    <div class="sales-bars" id="salesBars">
                        <div class="sales-bar" data-day="Mon" data-value="2100">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Mon</div>
                        </div>
                        <div class="sales-bar" data-day="Tue" data-value="3200">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Tue</div>
                        </div>
                        <div class="sales-bar" data-day="Wed" data-value="2800">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Wed</div>
                        </div>
                        <div class="sales-bar" data-day="Thu" data-value="3900">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Thu</div>
                        </div>
                        <div class="sales-bar" data-day="Fri" data-value="2285">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Fri</div>
                        </div>
                        <div class="sales-bar" data-day="Sat" data-value="0">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Sat</div>
                        </div>
                        <div class="sales-bar" data-day="Sun" data-value="0">
                            <div class="sales-bar-fill" style="height: 0%"></div>
                            <div class="sales-bar-value"></div>
                            <div class="sales-bar-label">Sun</div>
                        </div>
                    </div>
                </div>
                
                <div class="weekly-stats">
                    <div class="stat-card" id="statCard1">
                        <div class="stat-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div>
                            <div class="stat-value">8</div>
                            <div class="stat-label">Active Franchises</div>
                        </div>
                    </div>
                    <div class="stat-card" id="statCard2">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <div class="stat-value">24</div>
                            <div class="stat-label">Staff Members</div>
                        </div>
                    </div>
                    <div class="stat-card" id="statCard3">
                        <div class="stat-icon">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div>
                            <div class="stat-value">3</div>
                            <div class="stat-label">Pending Deliveries</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="products-section" id="productsSection">
                <div class="section-header">
                    <h2 class="section-title">Best Selling Products This Week</h2>
                    <div class="product-count" id="bestSellingCount">4/4</div>
                </div>
                <div class="products-grid" id="bestSellingProducts">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- New Arrivals Section -->
            <div class="products-section" id="newArrivalsSection">
                <div class="section-header">
                    <h2 class="section-title">New Arrivals</h2>
                    <div class="product-count" id="newArrivalsCount">4/4</div>
                </div>
                <div class="products-grid" id="newArrivalsProducts">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="product-modal">
            <button class="modal-close" id="modalClose">&times;</button>
            <div class="modal-content">
                <div class="modal-image" id="modalImage"></div>
                <div class="modal-details">
                    <span class="modal-category" id="modalCategory"></span>
                    <h2 class="modal-title" id="modalTitle"></h2>
                    <div class="modal-price currency" id="modalPrice"></div>
                    <p class="modal-description" id="modalDescription"></p>
                    
                    <div class="modal-stats">
                        <div class="modal-stat">
                            <div class="modal-stat-value" id="modalSold"></div>
                            <div class="modal-stat-label">Units Sold</div>
                        </div>
                        <div class="modal-stat">
                            <div class="modal-stat-value" id="modalStock"></div>
                            <div class="modal-stat-label">In Stock</div>
                        </div>
                        <div class="modal-stat">
                            <div class="modal-stat-value" id="modalRating"></div>
                            <div class="modal-stat-label">Rating</div>
                        </div>
                        <div class="modal-stat">
                            <div class="modal-stat-value" id="modalReviews"></div>
                            <div class="modal-stat-label">Reviews</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCOb4BqfiN3vt1Y13UTEpA_boCqNRH6rrQ",
            authDomain: "dsog-stores-dashboard.firebaseapp.com",
            databaseURL: "https://dsog-stores-dashboard-default-rtdb.firebaseio.com",
            projectId: "dsog-stores-dashboard",
            storageBucket: "dsog-stores-dashboard.firebasestorage.app",
            messagingSenderId: "1085972125142",
            appId: "1:1085972125142:web:9abea9ee0dd792a052c077"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();
        
        // Default data structure - LIMITED TO 4 PRODUCTS PER SECTION
        const defaultData = {
            metrics: {
                weeklySales: 14285,
                growth: 12,
                daysRemaining: 4,
                productsSold: 117
            },
            stats: {
                franchises: 8,
                staff: 24,
                deliveries: 3
            },
            target: {
                weeklyTarget: 22000,
                dailySales: [2100, 3200, 2800, 3900, 2285, 0, 0]
            },
            bestSellingProducts: [
                {
                    id: 1,
                    name: "Epitome White T-Shirt",
                    category: "Accessories",
                    price: "249",
                    image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "42",
                    total: "10458",
                    description: "Premium quality cotton t-shirt with unique graphic print. Comfortable fit for everyday wear. Available in multiple sizes and colors.",
                    stock: "28",
                    rating: "4.8",
                    reviews: "36"
                },
                {
                    id: 2,
                    name: "Designer Tote",
                    category: "Handbags",
                    price: "189",
                    image: "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "28",
                    total: "5292",
                    description: "Elegant and spacious tote bag made from sustainable materials. Features multiple compartments and sturdy handles.",
                    stock: "15",
                    rating: "4.6",
                    reviews: "24"
                },
                {
                    id: 3,
                    name: "Classic Denim Jacket",
                    category: "Fashion",
                    price: "349",
                    image: "https://images.unsplash.com/photo-1551028719-00167b16eac5?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "35",
                    total: "12215",
                    description: "Timeless denim jacket with a modern fit. Perfect for layering in any season. Available in multiple washes.",
                    stock: "12",
                    rating: "4.7",
                    reviews: "42"
                },
                {
                    id: 4,
                    name: "Leather Wallet",
                    category: "Accessories",
                    price: "129",
                    image: "https://images.unsplash.com/photo-1627123424574-724758594e93?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "12",
                    total: "1548",
                    description: "Genuine leather wallet with multiple card slots and a coin compartment. Slim design fits comfortably in any pocket.",
                    stock: "22",
                    rating: "4.5",
                    reviews: "18"
                }
            ],
            newArrivals: [
                {
                    id: 1,
                    name: "Summer Dress",
                    category: "Fashion",
                    price: "79",
                    image: "https://images.unsplash.com/photo-1496747611176-843222e1e57c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                    sold: "0",
                    total: "0",
                    description: "Light and flowy summer dress with floral pattern. Perfect for warm weather and special occasions.",
                    stock: "25",
                    rating: "New",
                    reviews: "0"
                },
                {
                    id: 2,
                    name: "Decorative Pillow",
                    category: "Home",
                    price: "45",
                    image: "https://images.unsplash.com/photo-1505843490537-8de44d869c18?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                    sold: "0",
                    total: "0",
                    description: "Soft and luxurious decorative pillow with intricate embroidery. Adds a touch of elegance to any room.",
                    stock: "40",
                    rating: "New",
                    reviews: "0"
                },
                {
                    id: 3,
                    name: "Wireless Earbuds",
                    category: "Electronics",
                    price: "199",
                    image: "https://images.unsplash.com/photo-1590658165737-15a047b8b5e1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "0",
                    total: "0",
                    description: "High-quality wireless earbuds with noise cancellation and 24-hour battery life. Perfect for music and calls.",
                    stock: "30",
                    rating: "New",
                    reviews: "0"
                },
                {
                    id: 4,
                    name: "Yoga Mat",
                    category: "Fitness",
                    price: "65",
                    image: "https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                    sold: "0",
                    total: "0",
                    description: "Non-slip yoga mat with extra cushioning for comfort. Perfect for yoga, pilates, and floor exercises.",
                    stock: "35",
                    rating: "New",
                    reviews: "0"
                }
            ]
        };

        // Authentication state observer
        auth.onAuthStateChanged((user) => {
            if (user) {
                // User is signed in
                handleUserSignedIn(user);
            } else {
                // User is signed out
                handleUserSignedOut();
            }
        });

        function handleUserSignedIn(user) {
            console.log("User signed in:", user.email);
            
            // Hide login modal
            document.getElementById('loginModal').style.display = 'none';
            
            // Show user info and admin controls
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('toggleAdminBtn').style.display = 'block';
            document.getElementById('userEmail').textContent = user.email;
            
            // Initialize the rest of the dashboard
            initializeDashboard();
        }

        function handleUserSignedOut() {
            console.log("User signed out");
            
            // Show login modal
            document.getElementById('loginModal').style.display = 'flex';
            
            // Hide user info and admin controls
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('toggleAdminBtn').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
        }

        // Login functionality
        document.getElementById('loginBtn').addEventListener('click', function() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const loginError = document.getElementById('loginError');
            
            if (!email || !password) {
                loginError.textContent = "Please enter both email and password.";
                loginError.style.display = 'block';
                return;
            }
            
            // Show loading state
            this.disabled = true;
            this.textContent = "Signing in...";
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Signed in successfully
                    loginError.style.display = 'none';
                })
                .catch((error) => {
                    // Handle errors
                    console.error("Login error:", error);
                    loginError.textContent = "Invalid email or password. Please try again.";
                    loginError.style.display = 'block';
                    
                    // Reset button
                    this.disabled = false;
                    this.textContent = "Sign In";
                });
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            auth.signOut()
                .then(() => {
                    showNotification('‚úÖ Successfully logged out', 'success');
                })
                .catch((error) => {
                    console.error("Logout error:", error);
                    showNotification('‚ùå Error logging out', 'error');
                });
        });

        // Allow pressing Enter to login
        document.getElementById('loginPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginBtn').click();
            }
        });

        function initializeDashboard() {
            // Your existing dashboard initialization code
            const adminPanel = document.getElementById('adminPanel');
            const toggleAdminBtn = document.getElementById('toggleAdminBtn');
            
            toggleAdminBtn.addEventListener('click', function() {
                if (adminPanel.style.display === 'none') {
                    adminPanel.style.display = 'block';
                    this.textContent = 'üë§ Hide Admin Panel';
                    loadCurrentData();
                } else {
                    adminPanel.style.display = 'none';
                    this.textContent = 'üë§ Show Admin Panel';
                }
            });
        
            // Listen for real-time updates
            database.ref('dashboard').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    updateEntireDashboard(data);
                    // Also update admin button states when data changes
                    updateAddButtonStates(data);
                } else {
                    // Initialize with default data if no data exists
                    database.ref('dashboard').set(defaultData);
                }
            });
        
            // Clock functionality
            function updateClock() {
                const now = new Date();
                let hours = now.getHours();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                hours = hours ? hours : 12;
                const minutes = now.getMinutes().toString().padStart(2, '0');
                
                document.getElementById('time').textContent = `${hours}:${minutes} ${ampm}`;
                
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('date').textContent = now.toLocaleDateString('en-US', options);
            }
            
            updateClock();
            setInterval(updateClock, 60000);
        
            // Animation observer
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add("visible");
                    }
                });
            }, { threshold: 0.1 });
        
            [document.getElementById("metricCard1"), document.getElementById("metricCard2"), 
             document.getElementById("metricCard3"), document.getElementById("metricCard4"),
             document.getElementById("targetCard"), document.getElementById("statCard1"),
             document.getElementById("statCard2"), document.getElementById("statCard3"),
             document.getElementById("productsSection"), document.getElementById("newArrivalsSection")]
            .forEach(el => { if (el) observer.observe(el); });
        
            // Close modal functionality
            document.getElementById('modalClose').addEventListener('click', function() {
                document.getElementById('productModal').classList.remove('active');
                document.body.style.overflow = 'auto';
            });
        
            document.getElementById('productModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
        }

        // Update entire dashboard with new data
        function updateEntireDashboard(data) {
            console.log("Updating dashboard with:", data); // Debug log
            
            // Update metrics
            document.querySelector('#metricCard1 .metric-value').textContent = formatNumber(data.metrics.weeklySales);
            document.querySelector('#metricCard2 .metric-value').textContent = `+${data.metrics.growth}%`;
            document.querySelector('#metricCard3 .metric-value').textContent = data.metrics.daysRemaining;
            document.querySelector('#metricCard4 .metric-value').textContent = data.metrics.productsSold;
            
            // Update stats
            document.querySelector('#statCard1 .stat-value').textContent = data.stats.franchises;
            document.querySelector('#statCard2 .stat-value').textContent = data.stats.staff;
            document.querySelector('#statCard3 .stat-value').textContent = data.stats.deliveries;
            
            // Update target section
            const progress = (data.metrics.weeklySales / data.target.weeklyTarget) * 100;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = `${progress}%`;
            progressBar.querySelector('.progress-text').textContent = `${Math.round(progress)}%`;
            
            const targetDetails = document.querySelector('.target-details');
            targetDetails.children[0].innerHTML = `Current: <span class="currency">${formatNumber(data.metrics.weeklySales)}</span>`;
            targetDetails.children[1].innerHTML = `Target: <span class="currency">${formatNumber(data.target.weeklyTarget)}</span>`;
            targetDetails.children[2].innerHTML = `Remaining: <span class="currency">${formatNumber(data.target.weeklyTarget - data.metrics.weeklySales)}</span>`;
            
            // Update sales bars
            updateSalesBars(data.target.dailySales);
            
            // Update products - LIMIT TO 4 PRODUCTS
            const limitedBestSelling = data.bestSellingProducts.slice(0, 4);
            const limitedNewArrivals = data.newArrivals.slice(0, 4);
            
            renderProducts(limitedBestSelling, 'bestSellingProducts');
            renderProducts(limitedNewArrivals, 'newArrivalsProducts');
            
            // Update product counts
            document.getElementById('bestSellingCount').textContent = `${limitedBestSelling.length}/4`;
            document.getElementById('newArrivalsCount').textContent = `${limitedNewArrivals.length}/4`;
        }
        
        // Render products to the page
        function renderProducts(products, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '';
            products.forEach((product, index) => {
                html += `
                    <div class="product-card" id="${containerId.slice(0, -1)}${index + 1}" data-product='${JSON.stringify(product).replace(/'/g, "&apos;")}'>
                        <div class="product-image" style="background-image: url('${product.image}'), linear-gradient(135deg, #2d2d44, #1a1a2e)"></div>
                        <div class="product-info">
                            <span class="product-category">${product.category}</span>
                            ${containerId === 'newArrivalsProducts' ? '<span class="new-arrival-badge">New!</span>' : ''}
                            <h3 class="product-name">${product.name}</h3>
                            <div class="product-price currency">${product.price}</div>
                            <div class="product-meta">
                                <span>${product.sold > 0 ? `Sold: ${product.sold} units` : `Available: ${product.stock}`}</span>
                                <span>Total: <span class="currency">${product.total}</span></span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Add animation observer for the new product cards
            const productCards = container.querySelectorAll('.product-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add("visible");
                    }
                });
            }, { threshold: 0.1 });
            
            productCards.forEach((card, index) => {
                // Observe each card for animations
                observer.observe(card);
                
                // Add click event directly to each card
                card.addEventListener('click', function() {
                    const productData = JSON.parse(this.getAttribute('data-product'));
                    showProductModal(productData);
                });
            });
        }
        
        // Show product modal
        function showProductModal(productData) {
            const modalImage = document.getElementById('modalImage');
            const modalCategory = document.getElementById('modalCategory');
            const modalTitle = document.getElementById('modalTitle');
            const modalPrice = document.getElementById('modalPrice');
            const modalDescription = document.getElementById('modalDescription');
            const modalSold = document.getElementById('modalSold');
            const modalStock = document.getElementById('modalStock');
            const modalRating = document.getElementById('modalRating');
            const modalReviews = document.getElementById('modalReviews');
            const productModal = document.getElementById('productModal');
            
            modalImage.style.backgroundImage = `url('${productData.image}')`;
            modalCategory.textContent = productData.category;
            modalTitle.textContent = productData.name;
            modalPrice.textContent = productData.price;
            modalDescription.textContent = productData.description;
            modalSold.textContent = productData.sold + (productData.sold > 0 ? ' units' : '');
            modalStock.textContent = productData.stock + ' available';
            modalRating.textContent = productData.rating;
            modalReviews.textContent = productData.reviews;
            
            productModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Update sales bars
        function updateSalesBars(dailySales) {
            const salesBars = document.querySelectorAll('.sales-bar');
            const maxValue = Math.max(...dailySales, 4000);
            
            salesBars.forEach((bar, index) => {
                const value = dailySales[index] || 0;
                const percentage = (value / maxValue) * 100;
                const fill = bar.querySelector('.sales-bar-fill');
                const valueDisplay = bar.querySelector('.sales-bar-value');
                
                bar.setAttribute('data-value', value);
                fill.style.height = `${percentage}%`;
                valueDisplay.textContent = value > 0 ? `Ksh ${formatNumber(value)}` : '';
            });
        }
        
        // Format numbers with commas
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // ================= ADMIN FUNCTIONS =================
        
        function loadCurrentData() {
            database.ref('dashboard').once('value').then((snapshot) => {
                const data = snapshot.val();
                if (data) {
                    console.log("Loading current data:", data); // Debug log
                    
                    // Load metrics
                    document.getElementById('adminWeeklySales').value = data.metrics.weeklySales;
                    document.getElementById('adminGrowth').value = data.metrics.growth;
                    document.getElementById('adminProductsSold').value = data.metrics.productsSold;
                    document.getElementById('adminDaysRemaining').value = data.metrics.daysRemaining;
                    
                    // Load stats
                    document.getElementById('adminFranchises').value = data.stats.franchises;
                    document.getElementById('adminStaff').value = data.stats.staff;
                    document.getElementById('adminDeliveries').value = data.stats.deliveries;
                    
                    // Load target
                    document.getElementById('adminWeeklyTarget').value = data.target.weeklyTarget;
                    document.getElementById('adminDailySales').value = data.target.dailySales.join(',');
                    
                    // Load products into admin panels
                    renderProductAdminForms(data.bestSellingProducts, 'bestSellingProductsAdmin', 'bestSellingProducts');
                    renderProductAdminForms(data.newArrivals, 'newArrivalsAdmin', 'newArrivals');
                    
                    // Update add button states based on current product counts
                    updateAddButtonStates(data);
                }
            });
        }
        
        function renderProductAdminForms(products, adminContainerId, dataKey) {
            const container = document.getElementById(adminContainerId);
            let html = '';
            
            // Limit display to 4 products in admin panel too
            const limitedProducts = products.slice(0, 4);
            
            limitedProducts.forEach((product, index) => {
                html += `
                    <div class="admin-section" style="background: rgba(255,255,255,0.02); margin-bottom: 15px; padding: 15px; border-radius: 6px; border-left: 3px solid var(--light-pink);">
                        <h5 style="color: var(--soft-teal); margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                            <span>Product ${index + 1}</span>
                            <button class="admin-btn" onclick="removeProduct('${dataKey}', ${index})" style="background: #ff4757; padding: 5px 10px; font-size: 12px;">Remove</button>
                        </h5>
                        <div class="admin-grid">
                            <div class="admin-input-group">
                                <label>Product Name</label>
                                <input type="text" value="${product.name}" onchange="updateProductField('${dataKey}', ${index}, 'name', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Category</label>
                                <input type="text" value="${product.category}" onchange="updateProductField('${dataKey}', ${index}, 'category', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Price (Ksh)</label>
                                <input type="number" value="${product.price}" onchange="updateProductField('${dataKey}', ${index}, 'price', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Image URL</label>
                                <input type="text" value="${product.image}" onchange="updateProductField('${dataKey}', ${index}, 'image', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Units Sold</label>
                                <input type="number" value="${product.sold}" onchange="updateProductField('${dataKey}', ${index}, 'sold', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Stock Available</label>
                                <input type="number" value="${product.stock}" onchange="updateProductField('${dataKey}', ${index}, 'stock', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Rating</label>
                                <input type="text" value="${product.rating}" onchange="updateProductField('${dataKey}', ${index}, 'rating', this.value)">
                            </div>
                            <div class="admin-input-group">
                                <label>Reviews Count</label>
                                <input type="number" value="${product.reviews}" onchange="updateProductField('${dataKey}', ${index}, 'reviews', this.value)">
                            </div>
                        </div>
                        <div class="admin-input-group">
                            <label>Description</label>
                            <textarea onchange="updateProductField('${dataKey}', ${index}, 'description', this.value)" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--light-pink); background: rgba(255,255,255,0.1); color: white; height: 60px; resize: vertical;">${product.description}</textarea>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateProductField(section, index, field, value) {
            database.ref('dashboard').once('value').then((snapshot) => {
                const data = snapshot.val();
                
                if (data && data[section] && data[section][index]) {
                    data[section][index][field] = value;
                    
                    // Recalculate total if sold or price changed
                    if (field === 'sold' || field === 'price') {
                        const sold = parseInt(data[section][index].sold) || 0;
                        const price = parseInt(data[section][index].price) || 0;
                        data[section][index].total = (sold * price).toString();
                    }
                    
                    database.ref('dashboard').set(data);
                }
            });
        }
        
        function addProduct(section) {
            database.ref('dashboard').once('value').then((snapshot) => {
                const data = snapshot.val();
                const sectionKey = section === 'bestSelling' ? 'bestSellingProducts' : 'newArrivals';
                
                // Check if we've reached the maximum of 4 products
                if (data[sectionKey].length >= 4) {
                    showNotification('‚ùå Maximum of 4 products reached for this section!', 'error');
                    return;
                }
                
                const newProduct = {
                    id: Date.now(), // Unique ID based on timestamp
                    name: "New Product",
                    category: "Category",
                    price: "99",
                    image: "https://images.unsplash.com/photo-1560769684-5507c64e2f7f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                    sold: "0",
                    total: "0",
                    description: "Enter product description here...",
                    stock: "10",
                    rating: "4.0",
                    reviews: "0"
                };
                
                data[sectionKey].push(newProduct);
                database.ref('dashboard').set(data)
                    .then(() => {
                        showNotification('‚úÖ New product added!', 'success');
                        // Update button states after successful addition
                        updateAddButtonStates(data);
                    })
                    .catch((error) => {
                        showNotification('‚ùå Error adding product: ' + error.message, 'error');
                    });
            });
        }
        
        function removeProduct(section, index) {
            if (confirm('Are you sure you want to remove this product?')) {
                database.ref('dashboard').once('value').then((snapshot) => {
                    const data = snapshot.val();
                    
                    if (data && data[section] && data[section][index]) {
                        data[section].splice(index, 1);
                        database.ref('dashboard').set(data)
                            .then(() => {
                                showNotification('‚úÖ Product removed!', 'success');
                                // Reload the current data to get updated counts
                                loadCurrentData();
                            })
                            .catch((error) => {
                                showNotification('‚ùå Error removing product: ' + error.message, 'error');
                            });
                    }
                });
            }
        }
        
        function updateAddButtonStates(data) {
            // Enable/disable add buttons based on current product counts
            const bestSellingBtn = document.getElementById('addBestSellingBtn');
            const newArrivalsBtn = document.getElementById('addNewArrivalBtn');
            
            if (!data) return;
            
            const bestSellingCount = data.bestSellingProducts ? data.bestSellingProducts.length : 0;
            const newArrivalsCount = data.newArrivals ? data.newArrivals.length : 0;
            
            console.log(`Updating buttons - Best Selling: ${bestSellingCount}/4, New Arrivals: ${newArrivalsCount}/4`);
            
            if (bestSellingCount >= 4) {
                bestSellingBtn.disabled = true;
                bestSellingBtn.textContent = "Max 4 Products";
            } else {
                bestSellingBtn.disabled = false;
                bestSellingBtn.textContent = "+ Add Product";
            }
            
            if (newArrivalsCount >= 4) {
                newArrivalsBtn.disabled = true;
                newArrivalsBtn.textContent = "Max 4 Products";
            } else {
                newArrivalsBtn.disabled = false;
                newArrivalsBtn.textContent = "+ Add Product";
            }
        }
        
        function updateAllData() {
            const weeklySales = parseInt(document.getElementById('adminWeeklySales').value) || 14285;
            const growth = parseInt(document.getElementById('adminGrowth').value) || 12;
            const productsSold = parseInt(document.getElementById('adminProductsSold').value) || 117;
            const daysRemaining = parseInt(document.getElementById('adminDaysRemaining').value) || 4;
            const franchises = parseInt(document.getElementById('adminFranchises').value) || 8;
            const staff = parseInt(document.getElementById('adminStaff').value) || 24;
            const deliveries = parseInt(document.getElementById('adminDeliveries').value) || 3;
            const weeklyTarget = parseInt(document.getElementById('adminWeeklyTarget').value) || 22000;
            const dailySalesInput = document.getElementById('adminDailySales').value || "2100,3200,2800,3900,2285,0,0";
            const dailySales = dailySalesInput.split(',').map(num => parseInt(num) || 0);
            
            // Get current product data to preserve it
            database.ref('dashboard').once('value').then((snapshot) => {
                const currentData = snapshot.val();
                
                const updatedData = {
                    metrics: {
                        weeklySales: weeklySales,
                        growth: growth,
                        daysRemaining: daysRemaining,
                        productsSold: productsSold
                    },
                    stats: {
                        franchises: franchises,
                        staff: staff,
                        deliveries: deliveries
                    },
                    target: {
                        weeklyTarget: weeklyTarget,
                        dailySales: dailySales
                    },
                    // Preserve the existing product data
                    bestSellingProducts: currentData.bestSellingProducts || defaultData.bestSellingProducts,
                    newArrivals: currentData.newArrivals || defaultData.newArrivals
                };
                
                database.ref('dashboard').set(updatedData)
                    .then(() => {
                        showNotification('‚úÖ All data updated successfully!', 'success');
                    })
                    .catch((error) => {
                        showNotification('‚ùå Error updating data: ' + error.message, 'error');
                    });
            });
        }
        
        function resetToDefault() {
            if (confirm('Are you sure you want to reset all data to default values?')) {
                database.ref('dashboard').set(defaultData)
                    .then(() => {
                        showNotification('‚úÖ Data reset to default values!', 'success');
                    })
                    .catch((error) => {
                        showNotification('‚ùå Error resetting data: ' + error.message, 'error');
                    });
            }
        }
        
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 4px;
                color: white;
                font-weight: bold;
                z-index: 10000;
                background: ${type === 'success' ? '#4CAF50' : '#f44336'};
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>
