<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ERH - Enterprise Resource Hub - Workspace</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    /* Your existing CSS remains exactly the same */
    :root {
      --dark-blue: #0a192f;
      --medium-blue: #172a45;
      --light-blue: #64ffda;
      --accent-gold: #e6c78a;
      --soft-teal: #81c8be;
      --text-primary: #f0e6ef;
      --text-secondary: #b8b8d1;
    }

    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Poppins', sans-serif;
      background-color: var(--dark-blue);
      color: var(--text-primary);
      overflow-x: hidden;
    }

    .background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--dark-blue);
      z-index: -2;
    }
    
    .background-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: radial-gradient(circle at 25% 25%, rgba(100, 255, 218, 0.1) 0%, transparent 50%);
      background-size: 400% 400%;
      z-index: -1;
      animation: gradientMove 30s ease infinite;
    }
    
    @keyframes gradientMove {
      0% { background-position: 0% 0%; }
      50% { background-position: 100% 100%; }
      100% { background-position: 0% 0%; }
    }

    /* Layout structure */
    .app-container {
      display: flex;
      height: 100vh;
      min-height: 0;
      width: 100%;
    }

    /* Side navigation */
    .sidenav {
      width: 280px;
      background: var(--medium-blue);
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      flex-shrink: 0;
      z-index: 10;
      overflow: hidden;
    }

    .nav-logo-placeholder {
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 1px solid rgba(100, 255, 218, 0.2);
      padding: 20px 0;
    }

    .logo-img {
      width: 60px;
      height: 60px;
      background: rgba(100, 255, 218, 0.15);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--light-blue);
      font-size: 1.8rem;
    }

    .hub-code {
      padding: 20px;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 1px;
      text-align: center;
      border-bottom: 1px solid rgba(100, 255, 218, 0.2);
      margin-bottom: 20px;
      color: var(--light-blue);
    }

    .nav-spacer {
      height: 30px;
    }

    .nav-links {
      list-style: none;
      padding: 0 15px;
      margin: 0;
      flex: 1;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 15px;
    }

    .nav-section-title {
      padding: 12px 20px;
      display: flex;
      align-items: center;
      cursor: pointer;
      color: var(--light-blue);
      font-weight: 600;
      border-radius: 8px;
      transition: all 0.3s ease;
      user-select: none;
    }

    .nav-section-title:hover {
      background: rgba(100, 255, 218, 0.1);
    }

    .nav-section-title i {
      margin-right: 15px;
      width: 20px;
      text-align: center;
      font-size: 1.1rem;
    }

    .nav-submenu {
      list-style: none;
      padding: 0;
      margin: 5px 0 15px 0;
      display: none;
    }

    .nav-section.active .nav-submenu {
      display: block;
    }

    .nav-link {
      padding: 12px 20px 12px 50px;
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--text-secondary);
      text-decoration: none;
      border-radius: 8px;
      font-size: 0.95rem;
      position: relative;
      user-select: none;
    }

    .nav-link:hover {
      color: var(--text-primary);
      background: rgba(100, 255, 218, 0.05);
    }

    .nav-link.active {
      color: var(--light-blue);
      font-weight: 500;
      background: rgba(100, 255, 218, 0.1);
    }

    .nav-link.active::before {
      content: "";
      position: absolute;
      left: 30px;
      top: 50%;
      transform: translateY(-50%);
      width: 6px;
      height: 6px;
      background: var(--light-blue);
      border-radius: 50%;
    }

    /* Main content area */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      background-color: var(--medium-blue);
      min-height: 0;
      position: relative;
      overflow: hidden;
    }

    /* Header styles */
    header {
      background: var(--medium-blue);
      color: var(--text-primary);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(100, 255, 218, 0.2);
      flex-shrink: 0;
      z-index: 5;
    }

    .hub-info {
      display: flex;
      flex-direction: column;
    }

    .hub-name {
      font-size: 1.3rem;
      font-weight: 500;
      color: var(--light-blue);
      margin: 0;
    }

    .hub-status {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 5px;
    }

    .header-actions {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .dashboard-nav {
      display: flex;
      gap: 10px;
    }

    .dashboard-nav a {
      padding: 8px 16px;
      border-radius: 6px;
      text-decoration: none;
      color: var(--text-secondary);
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .dashboard-nav a:hover {
      color: var(--text-primary);
      background: rgba(100, 255, 218, 0.05);
    }

    .dashboard-nav a.active {
      color: var(--light-blue);
      background: rgba(100, 255, 218, 0.1);
    }

    .datetime {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    #time {
      font-size: 1.1rem;
      font-weight: 500;
    }

    #date {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-top: 3px;
    }

    .dropdown {
      position: relative;
    }

    .menu-button {
      background: rgba(100, 255, 218, 0.1);
      color: var(--light-blue);
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid rgba(100, 255, 218, 0.2);
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .menu-button:hover {
      background: rgba(100, 255, 218, 0.2);
    }

    .dropdown-content {
      display: none;
      position: absolute;
      top: calc(100% + 5px);
      right: 0;
      min-width: 220px;
      background: var(--medium-blue);
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      border: 1px solid rgba(100, 255, 218, 0.2);
      overflow: hidden;
    }

    .dropdown-content a {
      display: block;
      padding: 10px 16px;
      text-decoration: none;
      font-size: 14px;
      color: var(--text-secondary);
      border-bottom: 1px solid rgba(100, 255, 218, 0.1);
      transition: all 0.3s ease;
    }

    .dropdown-content a:hover {
      color: var(--text-primary);
      background: rgba(100, 255, 218, 0.05);
    }

    .dropdown-content a:last-child {
      border-bottom: none;
    }

    .dropdown.open .dropdown-content {
      display: block;
    }

    /* Content area */
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      overflow: auto;
    }

    .iframe-container {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    iframe {
      border: none;
      width: 100%;
      height: 100%;
      min-height: 500px;
      background-color: #fff;
    }

    /* Footer */
    footer {
      background: var(--medium-blue);
      color: var(--text-secondary);
      text-align: center;
      font-size: 13px;
      padding: 12px 20px;
      border-top: 1px solid rgba(100, 255, 218, 0.2);
      flex-shrink: 0;
    }

    /* Responsive styles */
    @media (max-width: 1200px) {
      .sidenav {
        width: 240px;
      }
    }

    @media (max-width: 992px) {
      .sidenav {
        width: 80px;
      }
      
      .hub-code, .nav-section-title span, .nav-link span {
        display: none;
      }
      
      .nav-section-title {
        justify-content: center;
        padding: 16px 0;
      }
      
      .nav-section-title i {
        margin-right: 0;
        font-size: 1.3rem;
      }

      .nav-link {
        padding: 16px 0;
        justify-content: center;
      }

      .nav-link.active::before {
        left: 50%;
        transform: translate(-50%, -50%);
      }
      
      header {
        padding: 15px 20px;
      }
      
      .header-actions {
        gap: 15px;
      }
    }

    @media (max-width: 768px) {
      .app-container {
        flex-direction: column;
      }
      
      .sidenav {
        width: 100%;
        flex-direction: row;
        height: auto;
        margin-bottom: 0;
      }
      
      .nav-logo-placeholder, .hub-code, .nav-spacer {
        display: none;
      }
      
      .nav-links {
        display: flex;
        overflow-x: auto;
        padding: 0 10px;
      }
      
      .nav-section {
        margin-bottom: 0;
        margin-right: 5px;
        min-width: 80px;
      }

      .nav-section-title {
        padding: 15px 10px;
        border-radius: 0;
        white-space: nowrap;
      }

      .nav-submenu {
        position: absolute;
        background: var(--medium-blue);
        z-index: 100;
        min-width: 200px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        border-radius: 8px;
        overflow: hidden;
      }

      .nav-link {
        padding: 12px 15px;
        white-space: nowrap;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
        padding: 15px;
      }

      .header-actions {
        width: 100%;
        justify-content: space-between;
      }

      .dashboard-nav {
        flex-wrap: wrap;
      }

      .datetime {
        align-items: flex-start;
      }
      
      main {
        padding: 15px;
      }
    }

    @media (max-width: 600px) {
      .dropdown {
        width: 100%;
      }

      .dropdown-content {
        left: 0;
        right: auto;
        width: 100%;
      }

      .menu-button {
        width: 100%;
        justify-content: center;
      }
      
      .header-actions {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }
      
      .dashboard-nav {
        width: 100%;
        justify-content: space-between;
      }
      
      .datetime {
        width: 100%;
        align-items: flex-start;
      }
    }
    
    @media (max-width: 480px) {
      header {
        padding: 12px;
      }
      
      main {
        padding: 12px;
      }
      
      .hub-name {
        font-size: 1.1rem;
      }
      
      .dashboard-nav a {
        padding: 6px 10px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="background"></div>
  <div class="background-pattern"></div>

  <div class="app-container">
    <!-- Side Navigation -->
    <nav class="sidenav">
      <div class="nav-logo-placeholder">
        <div class="logo-img"><i class="fas fa-boxes"></i></div>
      </div>
      
      <div class="hub-code">ERH-PROD001</div>
      
      <div class="nav-spacer"></div>
      
      <ul class="nav-links">
        <!-- Product Portfolio Section -->
        <li class="nav-section active">
          <div class="nav-section-title">
            <i class="fas fa-project-diagram"></i>
            <span>Product Portfolio</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link active" data-section="portfolio-overview">
                <span>Portfolio Overview</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="product-lifecycle">
                <span>Product Lifecycle</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="collection-planning">
                <span>Collection Planning</span>
              </a>
            </li>
          </ul>
        </li>

        <!-- Design & Development Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-pencil-ruler"></i>
            <span>Design & Development</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="design-briefs">
                <span>Design Briefs</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="prototype-tracking">
                <span>Prototype Tracking</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="sample-management">
                <span>Sample Management</span>
              </a>
            </li>
          </ul>
        </li>

        <!-- Marketing & Sales Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-chart-line"></i>
            <span>Marketing & Sales</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="product-marketing">
                <span>Product Marketing</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="sales-performance">
                <span>Sales Performance</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="customer-feedback">
                <span>Customer Feedback</span>
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Procurement Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-shopping-cart"></i>
            <span>Procurement</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="supplier-management">
                <span>Supplier Management</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="purchase-orders">
                <span>Purchase Orders</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="sourcing">
                <span>Sourcing & RFQs</span>
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Inventory Management Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-warehouse"></i>
            <span>Inventory</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="inventory-control">
                <span>Inventory Control</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="stock-movements">
                <span>Stock Movements</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="warehouse">
                <span>Warehouse Management</span>
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Production Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-industry"></i>
            <span>Production</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="production-planning">
                <span>Production Planning</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="bill-of-materials">
                <span>Bill of Materials</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="work-orders">
                <span>Work Orders</span>
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Logistics Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-truck"></i>
            <span>Logistics</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="transportation">
                <span>Transportation</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="distribution">
                <span>Distribution</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="shipment-tracking">
                <span>Shipment Tracking</span>
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Analytics Section -->
        <li class="nav-section">
          <div class="nav-section-title">
            <i class="fas fa-chart-bar"></i>
            <span>Analytics</span>
          </div>
          <ul class="nav-submenu">
            <li>
              <a href="#" class="nav-link" data-section="supply-chain-analytics">
                <span>Supply Chain Analytics</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="kpi-dashboard">
                <span>KPI Dashboard</span>
              </a>
            </li>
            <li>
              <a href="#" class="nav-link" data-section="cost-analysis">
                <span>Cost Analysis</span>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
      <header>
        <div class="hub-info">
          <h1 class="hub-name">Enterprise Resource Hub - Workspace</h1>
          <div class="hub-status">Production System â€¢ All Systems Operational</div>
        </div>

        <div class="header-actions">
          <div class="dashboard-nav">
            <a href="erh-home.html" id="homeButton">Home</a>
            <a href="#" class="active" id="workspaceButton">Workspace</a>
            <a href="analytics.html" id="analyticsButton">Analytics</a>
          </div>

          <div class="datetime">
            <div id="time">10:45 AM</div>
            <div id="date">Friday, June 10, 2023</div>
          </div>

          <div class="dropdown" id="dropdown">
            <button class="menu-button" id="menuToggle">
              <i class="fas fa-tools"></i>
              <span>Tools</span>
            </button>
            <div class="dropdown-content" id="menuContent">
              <a href="#" data-link="portfolio-overview">Portfolio Overview</a>
              <a href="#" data-link="product-lifecycle">Product Lifecycle</a>
              <a href="#" data-link="collection-planning">Collection Planning</a>
              <a href="#" data-link="design-briefs">Design Briefs</a>
              <a href="#" data-link="prototype-tracking">Prototype Tracking</a>
            </div>
          </div>
        </div>
      </header>

      <main>
        <div class="iframe-container">
          <iframe id="iframe" loading="lazy" title="ERH Workspace Content"></iframe>
        </div>
      </main>

      <footer>Powered by ERH - Enterprise Resource Hub &copy; 2025</footer>
    </div>
  </div>

  <script>
    // Data for each section with sheet URLs for each tool - ALL YOUR ORIGINAL SHEETS RESTORED
    const moduleData = {
      // Product Portfolio - NEW SECTIONS
      "portfolio-overview": {
        title: "Product Portfolio Overview",
        tools: [
          { 
            name: "Portfolio Master", 
            link: "portfolio-master",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1_P6iqva9GrUYIHXIcCrdIlwVb6DU370hjQduUHgUwL8/edit" 
          },
          { 
            name: "Product Lines", 
            link: "product-lines",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1RruZGyllfitFtF39brm-zhJes3PJ_B-9r_WlxnHAsR0/edit" 
          },
          { 
            name: "Portfolio Performance", 
            link: "portfolio-performance",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1NRFRcX4aqII83AIcZEzKs5nr-muKM0hXHXwV5mpeQoI/edit" 
          }
        ]
      },
      "product-lifecycle": {
        title: "Product Lifecycle Management",
        tools: [
          { 
            name: "Lifecycle Tracking", 
            link: "lifecycle-tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1eeyC-KY5KWAhZQzNPcjgcNyjOqG-O8st0uSGHV_2-Es/edit" 
          },
          { 
            name: "Phase Management", 
            link: "phase-management",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1d_RSR94msDZ13wqh8hyBLyy95QHGim4E0g8AI6OdyrY/edit" 
          },
          { 
            name: "Milestone Tracking", 
            link: "milestone-tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1WpMiWFJXDPcj3axWIpJ7KBUNiLJvu5lBtaN-dK_Ru84/edit" 
          }
        ]
      },
      "collection-planning": {
        title: "Collection Planning",
        tools: [
          { 
            name: "Collection Calendar", 
            link: "collection-calendar",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1YevHH6wm09YHjUC-m1EYwkYe0mueYSs_L3vI8UZQ5T0/edit" 
          },
          { 
            name: "Season Planning", 
            link: "season-planning",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1IGa6E_QRCe2V3WUr-vnzFsgem1dTwXbgISTudltk-xw/edit" 
          },
          { 
            name: "Collection Budget", 
            link: "collection-budget",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1n_84d7oW-MwLBpkx61jweWrdNrwJqQM-q-t_jdaGs58/edit" 
          }
        ]
      },

      // Design & Development - NEW SECTIONS
      "design-briefs": {
        title: "Design Briefs",
        tools: [
          { 
            name: "Design Brief Master", 
            link: "design-brief-master",
            sheetUrl: "https://docs.google.com/spreadsheets/d/11-fzXzAaJ2qm9B5HlrouDGQK9HftvjBlbejbSWmLPdQ/edit" 
          },
          { 
            name: "Creative Direction", 
            link: "creative-direction",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1i5AEEsKuHGpESRZt7mXR7Ggxf8wQouNA_1PEFX04KQw/edit" 
          },
          { 
            name: "Design Specifications", 
            link: "design-specifications",
            sheetUrl: "https://docs.google.com/spreadsheets/d/17J5_Arfys1vePofSfP1O0jfZYu9adA3AF4ZGTJrbeng/edit" 
          }
        ]
      },
      "prototype-tracking": {
        title: "Prototype Tracking",
        tools: [
          { 
            name: "Prototype Status", 
            link: "prototype-status",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1OoH6hoxvrm_WtHvs9V8d89fIKaaeNXxdsWNkGKT7k8k/edit" 
          },
          { 
            name: "Prototype Feedback", 
            link: "prototype-feedback",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1PCjHqHcgQyzYbQ3zOTXoY9SaNWQEZ1-NyUpNhPevfCI/edit" 
          },
          { 
            name: "Prototype Costs", 
            link: "prototype-costs",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1CrtPjexy7Ga-MkjuuX7IWBqeFS4dr14DaSrrgxGwzVY/edit" 
          }
        ]
      },
      "sample-management": {
        title: "Sample Management",
        tools: [
          { 
            name: "Sample Tracking", 
            link: "sample-tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1eTKkMvQlMzkq1usiR1RgcpGtkz7qniEFqfpZWWc8SdQ/edit" 
          },
          { 
            name: "Sample Feedback", 
            link: "sample-feedback",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1_VBJG6FOllBozLBEt8WZqSP9gKETc0obFjSrlsV2E5Y/edit" 
          },
          { 
            name: "Sample Approval", 
            link: "sample-approval",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1XiDZgwANhPo8tjX8LUktt1hg6ZNY5cvrxvDr4Q0V3j4/edit" 
          }
        ]
      },

      // Marketing & Sales - NEW SECTIONS
      "product-marketing": {
        title: "Product Marketing",
        tools: [
          { 
            name: "Marketing Strategy", 
            link: "marketing-strategy",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1RWkCSdEbrnD0Ric1dI1Mepg6utYy-4wpwFnEEuF90uQ/edit" 
          },
          { 
            name: "Product Positioning", 
            link: "product-positioning",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1TxqDcANNwvnWwduy8areApEeA7spAUFsa06lamw9SDc/edit" 
          },
          { 
            name: "Marketing Calendar", 
            link: "marketing-calendar",
            sheetUrl: "https://docs.google.com/spreadsheets/d/15GORcqJ5RLuD6p2emAtDaV5S7HAEWvopVJapE7zbiDc/edit" 
          }
        ]
      },
      "sales-performance": {
        title: "Sales Performance",
        tools: [
          { 
            name: "Sales Dashboard", 
            link: "sales-dashboard",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1Ir2Vgy3jMXq-pP3GKpRV9SCdnvUwgyMYEiCScQn2V3Y/edit" 
          },
          { 
            name: "Product Performance", 
            link: "product-performance",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1ab8E3SM54_r0T37L6j4WbYSTx-OYOUixD3GegopjxLg/edit" 
          },
          { 
            name: "Sales Forecasting", 
            link: "sales-forecasting",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1OdQu1hPCDMjV8QM2p6dHCiHhWGb5u1xG9jdxk9OZMIU/edit" 
          }
        ]
      },
      "customer-feedback": {
        title: "Customer Feedback",
        tools: [
          { 
            name: "Feedback Analysis", 
            link: "feedback-analysis",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1La2sdTYqS4U0qFACIBG3NzaXmyIHllO5pyY6qQalX08/edit" 
          },
          { 
            name: "Customer Reviews", 
            link: "customer-reviews",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1QYXhBryLpDHh8brKASIIyYIBSaXxqcOqL-epqO2Feeo/edit" 
          },
          { 
            name: "Product Improvements", 
            link: "product-improvements",
            sheetUrl: "https://docs.google.com/spreadsheets/d/12OMRNRj-YFLUl0SIIrkbtywYaG-_MSXfaT3ASc3Umq8/edit" 
          }
        ]
      },

      // Procurement - ALL YOUR ORIGINAL SHEETS
      "supplier-management": {
        title: "Supplier Management",
        tools: [
          { 
            name: "Supplier Directory", 
            link: "supplier-list",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1hwJfrYlQQ70gtwDVaNMC80SXE7Vuw-UqZdhELYsnMFU/edit" 
          },
          { 
            name: "Supplier Performance", 
            link: "performance",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1Ui__Cbx7lU0QPvZAJDGMhC0HGEZ-Uh3vWnuSzO7vBME/edit" 
          },
          { 
            name: "Contracts & Agreements", 
            link: "contracts",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1aaNPvAXvk36UQOSzbo3rwUtCbRlnONRq1MIbdKJlWBk/edit" 
          },
          { 
            name: "Supplier Evaluation", 
            link: "evaluation",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1eFQDcUDwXLTlq6HGP7DcudPeYs5ig6hwiW6IrL0oaRc/edit" 
          },
          { 
            name: "Risk Assessment", 
            link: "risk",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1kkZHi0RoRKh5fi5c8YQctczauES6tTf-YanFmv7iFLY/edit" 
          }
        ]
      },
      "purchase-orders": {
        title: "Purchase Orders",
        tools: [
          { 
            name: "PO Creation", 
            link: "po-creation",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1hWkEjiJaQ6U1yaltAHIzab2bZpEUvOPxSSu9s2ZlfH8/edit" 
          },
          { 
            name: "PO Tracking", 
            link: "po-tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1WqNs6XSQztM56Jk6YTWAE7vUoYvlsUTxI199HiyALRo/edit" 
          },
          { 
            name: "PO Approval", 
            link: "po-approval",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1o-HqMkT637UNCL0OKzwWSXoYMjMVwif9GnLKMFUfBac/edit" 
          },
          { 
            name: "PO History", 
            link: "po-history",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1OK34p9bY8rxhCaWVe_NAU6LAnkWnXybaqJtBjDPCSH8/edit" 
          }
        ]
      },
      "sourcing": {
        title: "Sourcing & RFQs",
        tools: [
          { 
            name: "RFQ Management", 
            link: "rfq",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1QqogZOO6xrtWUUP-n2TiR4xfH7lNEdmpm2I7t0l5rjI/edit" 
          },
          { 
            name: "Bid Comparison", 
            link: "bid-comparison",
            sheetUrl: "https://docs.google.com/spreadsheets/d/19sGxaJk1qHuCk3RNrh4QbcY4X5jCW1trvhVrdUbsPc0/edit" 
          },
          { 
            name: "Vendor Selection", 
            link: "vendor-selection",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1R-B6Q2KmS7czqXd4fi6SzfHk_Bzmv_Sn7lTrNxgAE3I/edit" 
          }
        ]
      },
      
      // Inventory Management - ALL YOUR ORIGINAL SHEETS
      "inventory-control": {
        title: "Inventory Control",
        tools: [
          { 
            name: "Stock Levels", 
            link: "stock-levels",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1ptdoE4iNqxsU8-qb1GT4DchFToDSGcrY_gLfIGHpU64/edit" 
          },
          { 
            name: "Inventory Valuation", 
            link: "inventory-valuation",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1lyzJZce3BrtHcU36Di6Z_OTbiekSRrQBtZpvG2Mss48/edit" 
          },
          { 
            name: "Stock Alerts", 
            link: "stock-alerts",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1cNWxzotLFnpdq7udhlQcXQA2ngOeGMQE2C5aHSyNMbg/edit" 
          },
          { 
            name: "Cycle Counting", 
            link: "cycle-counting",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1SJOg8OapPEmTKANBNTpv9gTT3_syBjV40FJWEa6vO9k/edit" 
          }
        ]
      },
      "stock-movements": {
        title: "Stock Movements",
        tools: [
          { 
            name: "Receipts", 
            link: "receipts",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1p_JH72IMirO7YULPCQqYPRVLe3y6QhNpXdBN6wM1vaU/edit" 
          },
          { 
            name: "Issues", 
            link: "issues",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1d9J7tuVN5S75xTZXzW0YwinLz-vx8fadmKrCweUt0fQ/edit" 
          },
          { 
            name: "Transfers", 
            link: "transfers",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1rPOPVlS4NiW9gUXWux87fugVzWP3BSkpkhhHnNkzxDw/edit" 
          },
          { 
            name: "Adjustments", 
            link: "adjustments",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1gihht73Uk2PL77sZCrRtPXvaiy9S9yIsS5nJ5SQpEs4/edit" 
          }
        ]
      },
      "warehouse": {
        title: "Warehouse Management",
        tools: [
          { 
            name: "Location Management", 
            link: "locations",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1iIScOavt3DHV-_kj1PrHeI13ihqrsFiSc3ez86QLWL0/edit" 
          },
          { 
            name: "Bin Management", 
            link: "bin-management",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1aBK9PseMEGmUKvo4ddU8RRFMiTyOqMlPsoBNmI_v_Dw/edit" 
          },
          { 
            name: "Putaway Strategy", 
            link: "putaway",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1NAtIxvVpsgJ0n9NqRq4-g_m8ukfCjbbovXFSMFO4MUg/edit" 
          },
          { 
            name: "Picking Strategy", 
            link: "picking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1WHNNx1pV4bpQ8moXKUfD-Gec30H4OXxWwmvaV8DCvPc/edit" 
          }
        ]
      },
      
      // Production - ALL YOUR ORIGINAL SHEETS
      "production-planning": {
        title: "Production Planning",
        tools: [
          { 
            name: "Production Schedule", 
            link: "schedule",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1JCoywp2Xl5moDFh8R6fAS6vVqbpGo6vbjVfsWLUfiS0/edit" 
          },
          { 
            name: "Capacity Planning", 
            link: "capacity",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1eV7d017f47s7z7cpXPOD7vYBXRbaprokE4LzYtGBpG0/edit" 
          },
          { 
            name: "Material Requirements", 
            link: "mrp",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1sZhT0Wc2wP8p9zmzpTiN_luTGb2OBKJhRos9xjLZL5Q/edit" 
          },
          { 
            name: "Production Tracking", 
            link: "tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1ww6lA_c0gm2U3pJzCE1A2KmdJnRGBIapwNGr8aOF9rk/edit" 
          }
        ]
      },
      "bill-of-materials": {
        title: "Bill of Materials",
        tools: [
          { 
            name: "BOM Management", 
            link: "bom-management",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1Q3mvUG--QcP3soNePZfOLLpG0QxH7DxpggKFIAotvQg/edit" 
          },
          { 
            name: "BOM Explorer", 
            link: "bom-explorer",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1-tUAV3lxn8ThmpMNayEehrb0-X5dlyXpin5J0mGYMJQ/edit" 
          },
          { 
            name: "BOM Costing", 
            link: "bom-costing",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1mCLHg-TevxL9_YMqCOwesb70yOXEss-1lAyFdT-UEcE/edit" 
          },
          { 
            name: "BOM Versioning", 
            link: "bom-versioning",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1EZ3qVIQEpkYW6ma6-TH_pdMebTsbXNhY0Mxf2ZcBShY/edit" 
          }
        ]
      },
      "work-orders": {
        title: "Work Orders",
        tools: [
          { 
            name: "Work Order Creation", 
            link: "wo-creation",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1_rE50ge2koWL7LH4qL_fVoxiFaAJzZuAJaTsWhLWobI/edit" 
          },
          { 
            name: "Work Order Tracking", 
            link: "wo-tracking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/12eT6sFcgbsx0xj6uuHMu_5gUYDOPjpz20NSI4NM4KHY/edit" 
          },
          { 
            name: "Work Order History", 
            link: "wo-history",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1HhWSE3hSxuxfQtJYLliQZNngqCBH551r9J7XSiLa5kE/edit" 
          },
          { 
            name: "Work Order Costs", 
            link: "wo-costs",
            sheetUrl: "https://docs.google.com/spreadsheets/d/18QblOcA5idUfOdcFXYkq0xnOcZmuT4WS7o6Wl0VakfM/edit" 
          }
        ]
      },
      
      // Logistics - ALL YOUR ORIGINAL SHEETS
      "transportation": {
        title: "Transportation",
        tools: [
          { 
            name: "Carrier Management", 
            link: "carrier-management",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1KphtIOl8932GJXonSLbuJeG5VRgF43xTN3MNYamQRE4/edit" 
          },
          { 
            name: "Route Planning", 
            link: "route-planning",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1uuadkicYfd7Jv_f4OZF_40QRZxOGvaDup3R8-1RxTAY/edit" 
          },
          { 
            name: "Freight Costing", 
            link: "freight-costing",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1fepSBUDTrSXSnwVSDFx--eOJeQbRj7LtGKEmu0sKoO0/edit" 
          },
          { 
            name: "Transportation Schedule", 
            link: "transport-schedule",
            sheetUrl: "https://docs.google.com/spreadsheets/d/15KOjL-7b8ARClq_8JNUi_6aZT1Zcs7PRPpmVhSTiV-U/edit" 
          }
        ]
      },
      "distribution": {
        title: "Distribution",
        tools: [
          { 
            name: "Distribution Centers", 
            link: "distribution-centers",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1MVqyQ2rrzwQWn-548SN_8AWUjmrW4ghq-UIsm05MvRs/edit" 
          },
          { 
            name: "Delivery Scheduling", 
            link: "delivery-scheduling",
            sheetUrl: "https://docs.google.com/spreadsheets/d/14i_vLZFFI0yrlMAALXN_0_KAaW_AhKHG6FBoGISVkFw/edit" 
          },
          { 
            name: "Last Mile Tracking", 
            link: "last-mile",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1XxymMoyznVYlbNXxc93sdrvnnOd0tvv7mHhR91qk_po/edit" 
          },
          { 
            name: "Returns Management", 
            link: "returns",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1Ly31Ugoa5jI9p1DVMP8zVQpQR7x28urbfiAm2e9Vgs8/edit" 
          }
        ]
      },
      "shipment-tracking": {
        title: "Shipment Tracking",
        tools: [
          { 
            name: "Shipment Tracker", 
            link: "shipment-tracker",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1351dA3hFT6EhtnJ9BEn1HzYzPMRmAep0dDU6nVLfrv4/edit" 
          },
          { 
            name: "Customs Documentation", 
            link: "customs",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1RoxYorrGJT05GKg2Mht857KtuSnzy04Khgnh5z0a2K8/edit" 
          },
          { 
            name: "Shipment Exceptions", 
            link: "exceptions",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1F2VdG64GzoxSEMlwASRvWXtmnANg3FiZVwaih127GDo/edit" 
          },
          { 
            name: "Proof of Delivery", 
            link: "pod",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1I8CHZ6PmJrLYS_TMJ7KAHjhqwwvoqqY4Kj10THLJ3rM/edit" 
          }
        ]
      },
      
      // Analytics - ALL YOUR ORIGINAL SHEETS
      "supply-chain-analytics": {
        title: "Supply Chain Analytics",
        tools: [
          { 
            name: "Lead Time Analysis", 
            link: "lead-time",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1IzzKJ1hNnd56dnmDTX2SJE_PZM-K1E4uowwqKGfTdOs/edit" 
          },
          { 
            name: "Inventory Turnover", 
            link: "inventory-turnover",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1wwSvnKoxzFAECdDyKettJjD5HYhL3YXUyv535JEZHx4/edit" 
          },
          { 
            name: "Supplier Performance", 
            link: "supplier-performance",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1ojZ4SYX0G9f_WNVWWibZaPrQ3fQyAnmCLlVECdQFCxA/edit" 
          },
          { 
            name: "Cost-to-Serve", 
            link: "cost-to-serve",
            sheetUrl: "https://docs.google.com/spreadsheets/d/157LEDprxdh-3afuBJW1qpFq-5WzDo9AqmPn-xXk3gM8/edit" 
          }
        ]
      },
      "kpi-dashboard": {
        title: "KPI Dashboard",
        tools: [
          { 
            name: "SCOR Model KPIs", 
            link: "scor",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1SuQrJOiF2XQGpJlkGarclDVbIO_JMfKBY4xbaG29O4M/edit" 
          },
          { 
            name: "Operational KPIs", 
            link: "operational",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1HPIT7h8Ag7oNcJLGnHr5uI4NRqYVl1HZbieLnTjsZzE/edit" 
          },
          { 
            name: "Financial KPIs", 
            link: "financial",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1e5taaF2tVBitqxlSdYOUJGiDxmFinsAS3Q1KNivVQZo/edit" 
          },
          { 
            name: "Custom KPIs", 
            link: "custom",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1dih19fuVRVtqjzvPsTsuL4Ws-GuRtXFf1JSoUvuPyY4/edit" 
          }
        ]
      },
      "cost-analysis": {
        title: "Cost Analysis",
        tools: [
          { 
            name: "Total Cost Analysis", 
            link: "total-cost",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1l19WADHA0J9Iqz4qV2Hp_wAUFcuRpO-GNRob_4exWZs/edit" 
          },
          { 
            name: "Cost Breakdown", 
            link: "cost-breakdown",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1B_B-njDP-mRaLIaPRVZ3AYtsRVqVlx5ypn_Z53nBx1o/edit" 
          },
          { 
            name: "Cost Optimization", 
            link: "cost-optimization",
            sheetUrl: "https://docs.google.com/spreadsheets/d/13ToZ_Rx965bHvr0xLK9d97SxoYrznjBA6u0B3QSphC0/edit" 
          },
          { 
            name: "Cost Benchmarking", 
            link: "benchmarking",
            sheetUrl: "https://docs.google.com/spreadsheets/d/1BENCHMARKING_SHEET_ID/edit" 
          }
        ]
      }
    };

    // DOM elements and JavaScript functions remain exactly the same as your original
    const iframe = document.getElementById("iframe");
    const dropdown = document.getElementById("dropdown");
    const menuToggle = document.getElementById("menuToggle");
    const menuContent = document.getElementById("menuContent");
    const timeElement = document.getElementById("time");
    const dateElement = document.getElementById("date");
    const navSections = document.querySelectorAll(".nav-section");
    const navLinks = document.querySelectorAll(".nav-link");

    // Initialize the application
    function initApp() {
      setupEventListeners();
      loadInitialSection();
      updateClock();
      setInterval(updateClock, 60000);
    }

    // Set up all event listeners
    function setupEventListeners() {
      document.querySelectorAll(".nav-section-title").forEach(title => {
        title.addEventListener("click", function(e) {
          e.stopPropagation();
          const section = this.parentElement;
          navSections.forEach(s => {
            if (s !== section) s.classList.remove("active");
          });
          section.classList.toggle("active");
        });
      });

      navLinks.forEach(link => {
        link.addEventListener("click", function(e) {
          e.preventDefault();
          handleNavLinkClick(this);
        });
      });

      menuContent.addEventListener("click", function(e) {
        if (e.target.tagName === 'A') {
          e.preventDefault();
          handleToolClick(e.target);
        }
      });

      menuToggle.addEventListener("click", function(e) {
        e.stopPropagation();
        dropdown.classList.toggle("open");
      });

      document.addEventListener("click", function() {
        dropdown.classList.remove("open");
      });
    }

    function handleNavLinkClick(link) {
      navLinks.forEach(l => l.classList.remove("active"));
      link.classList.add("active");
      
      const section = link.dataset.section;
      const data = moduleData[section];
      
      if (!data) {
        console.error("No data found for section:", section);
        return;
      }
      
      updateToolsMenu(data.tools);
      
      if (data.tools.length > 0) {
        loadToolContent(data.tools[0].sheetUrl);
      }
    }

    function updateToolsMenu(tools) {
      menuContent.innerHTML = '';
      tools.forEach(tool => {
        const link = document.createElement('a');
        link.href = '#';
        link.textContent = tool.name;
        link.dataset.link = tool.link;
        link.dataset.sheetUrl = tool.sheetUrl;
        menuContent.appendChild(link);
      });
    }

    function handleToolClick(toolElement) {
      dropdown.classList.remove("open");
      const sheetUrl = toolElement.dataset.sheetUrl;
      loadToolContent(sheetUrl);
    }

    function loadToolContent(sheetUrl) {
      if (sheetUrl && sheetUrl.includes('docs.google.com')) {
        const sheetId = extractSheetId(sheetUrl);
        if (sheetId) {
          iframe.src = `https://docs.google.com/spreadsheets/d/${sheetId}/edit?usp=sharing`;
        } else {
          showPlaceholderContent("Invalid Google Sheet URL format");
        }
      } else {
        showPlaceholderContent("No Google Sheet configured for this tool");
      }
    }

    function showPlaceholderContent(message) {
      iframe.srcdoc = `
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            body {
              display: flex;
              justify-content: center;
              align-items: center;
              height: 100%;
              font-family: Arial, sans-serif;
              color: #666;
              background: #f9f9f9;
            }
            .content {
              text-align: center;
              padding: 20px;
              max-width: 500px;
            }
            i {
              font-size: 3rem;
              color: #ddd;
              margin-bottom: 20px;
            }
            h2 {
              color: #444;
              margin: 0 0 15px 0;
            }
            p {
              margin: 5px 0;
              line-height: 1.5;
            }
          </style>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        </head>
        <body>
          <div class="content">
            <i class="fas fa-exclamation-triangle"></i>
            <h2>Content Not Available</h2>
            <p>${message}</p>
            ${message.includes('configured') ? '<p>Please configure a valid Google Sheet URL in the moduleData object.</p>' : ''}
          </div>
        </body>
        </html>
      `;
    }

    function updateClock() {
      const now = new Date();
      let hours = now.getHours();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12;
      hours = hours ? hours : 12;
      const minutes = now.getMinutes().toString().padStart(2, '0');
      
      timeElement.textContent = `${hours}:${minutes} ${ampm}`;
      
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      dateElement.textContent = now.toLocaleDateString('en-US', options);
    }

    function extractSheetId(url) {
      try {
        const match = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
        return match ? match[1] : null;
      } catch (e) {
        console.error("Error extracting sheet ID:", e);
        return null;
      }
    }

    function loadInitialSection() {
      const activeLink = document.querySelector('.nav-link.active');
      if (activeLink) {
        handleNavLinkClick(activeLink);
      } else if (navLinks.length > 0) {
        navLinks[0].classList.add("active");
        handleNavLinkClick(navLinks[0]);
      }
    }

    document.addEventListener('DOMContentLoaded', initApp);
  </script>

</body>
</html>
